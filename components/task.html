<div id="task-template">
  <div class="task-item {{classes}}" id="task-{{id}}">
    <div>{{ name }}</div>
    <div>{{{ html_description }}}</div>
  </div>
</div>

<script>
let indexes = 0;
var Tasks = {};
class Task {
  constructor(cfg={}) {
    this.data = Object.assign({
      id: false,
      day: 'today',
      name: 'default name',
      description: '[bruh](https://example.com)',
      subtasks: [],
      color: false,
      completed: false,
    }, cfg);
    if (this.data.id == false) {
      this.data.id = ++indexes;
    }
    for (let key of Object.keys(this.data)) {
      Object.defineProperty(this, key, {
        get() {
          return this.data[key];
        },
        set(value) {
          this.data[key] = value;
          TaskList.update(this);
        }
      })
    }
    Tasks[this.data.id] = this;
  }
  render() {
    return Mustache.render(document.querySelector('#task-template').innerHTML, {
      ...this.data,
      classes: this.classes,
      html_description: marked(this.data.description),
    });
  }
  hook($el) {
    let task = this;
    $el.on('click', function() {
      task.completed = !task.completed;
    })
  }
  get classes() {
    let classes = {
      'task-completed': this.completed,
    };
    return Object.entries(classes).filter(o => o[1]).map(o => o[0]).join(' ');
  }
  swap() {
    if (this.day == 'today') {
      this.day = 'tomorrow';
    } else {
      this.day = 'today';
    }
  }

}
</script>

<style lang="scss">
  .task-item {
    &.task-completed {
      text-decoration: line-through;
    }
    //background-color: red;
    &:hover {
      //background-color: blue;
    }
  }
</style>
